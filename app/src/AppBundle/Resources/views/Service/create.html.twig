{% extends "AppBundle:Service:layout.html.twig" %}

{% block title %}Claim service{% endblock %}

{% block stylesheets %}
    {% stylesheets
    'css/progressbar.css'
    filter='cssrewrite' %}
    <link rel="stylesheet" href="{{ asset_url }}"/>
    {% endstylesheets %}
{% endblock %}

{% block container %}

    {% for flashMessage in app.session.flashbag.get('error') %}
        <div class="flash-error flash">
            <h4>There was some failure!</h4>
            {{ flashMessage|raw }}
        </div>
    {% endfor %}
    {% for flashMessage in app.session.flashbag.get('success') %}
        <div class="flash-success flash">
            {{ flashMessage|raw }}
        </div>
    {% endfor %}

    {{ form_start(form) }}

    <div id="first" class="progresswrapper">
        <div class="row">
            <div class="col-md-11 col-md-offset-2">
                {{ include('::progressbar.html.twig',
                {
                    header: 'Create service',
                    percent: 25,
                    next_id: 'second',
                    next_button_id: 'next-1'
                }
                ) }}
            </div>
        </div>


        <div class="text-center progressbar-order">Enter your service's main parameters
        </div>
        <fieldset id="createServiceFormFields">
            {{ form_row(form.name) }}
            <br><br>
            {{ form_row(form.description) }}
            <br><br>
            {{ form_row(form.url) }}
            <br><br>
            <div id="scrollable-dropdown-menu">
            {{ form_row(form.entityid) }}
            </div>

            {#{% for key, field in form  %}
                {% if field.vars.name == 'name' %}
            {{ form_label(field) }}
            {{ form_widget(field) }}
            {% if field.vars.valid|length %}
                <div class="col-sm-offset-3 col-sm-11 has-error">{{ field.vars.valid|length }}</div>
            {% endif %}
            {% endif %}
            {% endfor %}#}

        </fieldset>
    </div>


    <div id="second" class="hidden progresswrapper">
        <div class="row">
            <div class="col-md-11 col-md-offset-2">
                {{ include('::progressbar.html.twig',
                {
                    header: 'Create service',
                    prev_id: 'first',
                    done: 'next',
                    percent: 50,
                }
                ) }}
            </div>
        </div>

        <div class="text-center progressbar-order">Create your entitlements of your service</div>
        <fieldset>
            {{ form_row(form.entitlement) }}
            <br><br>
            {{ form_row(form.entitlementplus1) }}
            <br><br>
            {{ form_row(form.entitlementplus2) }}
        </fieldset>
    </div>


    {{ form_end(form) }}

    {% javascripts
    '@typeahead_js' %}
    <script type="text/javascript" src="{{ asset_url }}"></script>
    {% endjavascripts %}

    {{ form_javascript(form) }}

    <script>
       /* var form  = document.getElementsByTagName('form')[0];
        var name = $('#service_name');
        console.log(name);
        var error = document.querySelector('.error');

        $('#service_name').bind("input", function (event) {
            console.log('OJAJAJ');
            // Each time the user types something, we check if the
            // email field is valid.
            if ( $('#service_name').validity.valid) {
                console.log('HAHOÓÓÓ');
                // In case there is an error message visible, if the field
                // is valid, we remove the error message.
                error.innerHTML = ""; // Reset the content of the message
                error.className = "error"; // Reset the visual state of the message
            }
        }, false);
        $('form[name="service"]').bind("submit", function (event) {
            // Each time the user tries to send the data, we check
            // if the email field is valid.
            if (!name.validity.valid) {

                // If the field is not valid, we display a custom
                // error message.
                error.innerHTML = "I expect an e-mail, darling!";
                error.className = "error active";
                // And we prevent the form from being sent by canceling the event
                event.preventDefault();
            }
        }, false);*/
    </script>

{% endblock %}

{% block javascripts %}
    <script>
        {{ include('::progressbar.js.twig') }}
    </script>
{% endblock %}


